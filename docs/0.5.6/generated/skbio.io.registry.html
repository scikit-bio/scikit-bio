<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>I/O Registry (skbio.io.registry) &#8212; scikit-bio 0.5.6 documentation</title>
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/style.css" />
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="skbio.io.registry.IORegistry" href="skbio.io.registry.IORegistry.html" />
    <link rel="prev" title="skbio.io.StockholmFormatError" href="skbio.io.StockholmFormatError.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">
<script type="text/javascript" src="../_static/js/jquery-1.11.0.min.js "></script>
<script type="text/javascript" src="../_static/js/jquery-fix.js "></script>
<script type="text/javascript" src="../_static/bootstrap-3.3.7/js/bootstrap.min.js "></script>
<script type="text/javascript" src="../_static/bootstrap-sphinx.js "></script>

  </head><body>
  
  <a href="https://github.com/biocore/scikit-bio"
     class="visible-desktop hidden-xs"><img
    id="gh-banner"
    style="position: absolute; top: 50px; right: 0; border: 0;"
    src="https://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png"
    alt="Fork me on GitHub"></a>
  <script>
    // Adjust banner height.
    $(function () {
      var navHeight = $(".navbar .container").css("height");
      $("#gh-banner").css("top", navHeight);
    });
  </script>


  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../index.html">
          scikit-bio docs</a>
        <span class="navbar-text navbar-version pull-left"><b>0.5.6</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../io.html">File I/O (<code class="xref py py-mod docutils literal notranslate"><span class="pre">skbio.io</span></code>)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sequence.html">Sequences (<code class="xref py py-mod docutils literal notranslate"><span class="pre">skbio.sequence</span></code>)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../alignment.html">Alignments (<code class="xref py py-mod docutils literal notranslate"><span class="pre">skbio.alignment</span></code>)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tree.html">Tree representations (<code class="xref py py-mod docutils literal notranslate"><span class="pre">skbio.tree</span></code>)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../workflow.html">Constructing workflows (<code class="xref py py-mod docutils literal notranslate"><span class="pre">skbio.workflow</span></code>)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../diversity.html">Diversity calculations (<code class="xref py py-mod docutils literal notranslate"><span class="pre">skbio.diversity</span></code>)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../stats.html">Statistics (<code class="xref py py-mod docutils literal notranslate"><span class="pre">skbio.stats</span></code>)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../metadata.html">Metadata (<code class="xref py py-mod docutils literal notranslate"><span class="pre">skbio.metadata</span></code>)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../util.html">Utility functionality (<code class="xref py py-mod docutils literal notranslate"><span class="pre">skbio.util</span></code>)</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../user/api_stability.html">API Stability</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../development/coding_guidelines.html">Coding guidelines</a></li>
<li class="toctree-l1"><a class="reference internal" href="../development/new_module.html">Adding a new module to skbio</a></li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">I/O Registry (<code class="xref py py-mod docutils literal notranslate"><span class="pre">skbio.io.registry</span></code>)</a><ul>
<li><a class="reference internal" href="#classes">Classes</a></li>
<li><a class="reference internal" href="#functions">Functions</a></li>
<li><a class="reference internal" href="#exceptions">Exceptions</a></li>
<li><a class="reference internal" href="#creating-a-new-format-for-scikit-bio">Creating a new format for scikit-bio</a></li>
<li><a class="reference internal" href="#reserved-keyword-arguments">Reserved Keyword Arguments</a></li>
</ul>
</li>
</ul>
</ul>
</li>
              
            
            
            
            
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="body col-md-12 content" role="main">
      
  <span class="target" id="module-skbio.io.registry"></span><div class="section" id="i-o-registry-skbio-io-registry">
<h1>I/O Registry (<a class="reference internal" href="#module-skbio.io.registry" title="skbio.io.registry"><code class="xref py py-mod docutils literal notranslate"><span class="pre">skbio.io.registry</span></code></a>)<a class="headerlink" href="#i-o-registry-skbio-io-registry" title="Permalink to this headline">¶</a></h1>
<div class="section" id="classes">
<h2>Classes<a class="headerlink" href="#classes" title="Permalink to this headline">¶</a></h2>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="skbio.io.registry.IORegistry.html#skbio.io.registry.IORegistry" title="skbio.io.registry.IORegistry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">IORegistry</span></code></a>()</p></td>
<td><p>Create a registry of formats and implementations which map to classes.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="skbio.io.registry.Format.html#skbio.io.registry.Format" title="skbio.io.registry.Format"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Format</span></code></a>(name[, encoding, newline])</p></td>
<td><p>Defines a format on which readers/writers/sniffer can be registered.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="functions">
<h2>Functions<a class="headerlink" href="#functions" title="Permalink to this headline">¶</a></h2>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="skbio.io.registry.create_format.html#skbio.io.registry.create_format" title="skbio.io.registry.create_format"><code class="xref py py-obj docutils literal notranslate"><span class="pre">create_format</span></code></a>(self, *args, **kwargs)</p></td>
<td><p>A simple factory for creating new file formats.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="exceptions">
<h2>Exceptions<a class="headerlink" href="#exceptions" title="Permalink to this headline">¶</a></h2>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="skbio.io.registry.DuplicateRegistrationError.html#skbio.io.registry.DuplicateRegistrationError" title="skbio.io.registry.DuplicateRegistrationError"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DuplicateRegistrationError</span></code></a></p></td>
<td><p>Raised when a function is already registered in skbio.io</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="skbio.io.registry.InvalidRegistrationError.html#skbio.io.registry.InvalidRegistrationError" title="skbio.io.registry.InvalidRegistrationError"><code class="xref py py-obj docutils literal notranslate"><span class="pre">InvalidRegistrationError</span></code></a></p></td>
<td><p>Raised if function doesn’t meet the expected API of its registration.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="creating-a-new-format-for-scikit-bio">
<h2>Creating a new format for scikit-bio<a class="headerlink" href="#creating-a-new-format-for-scikit-bio" title="Permalink to this headline">¶</a></h2>
<p>scikit-bio makes it simple to add new file formats to its I/O registry.
scikit-bio maintains a singleton of the <a class="reference internal" href="skbio.io.registry.IORegistry.html#skbio.io.registry.IORegistry" title="skbio.io.registry.IORegistry"><code class="xref py py-class docutils literal notranslate"><span class="pre">IORegistry</span></code></a> class called
<cite>io_registry</cite>. This is where all scikit-bio file formats are registered. One
could also instantiate their own <a class="reference internal" href="skbio.io.registry.IORegistry.html#skbio.io.registry.IORegistry" title="skbio.io.registry.IORegistry"><code class="xref py py-class docutils literal notranslate"><span class="pre">IORegistry</span></code></a>, but that is not the focus
of this tutorial.</p>
<p>The first step to creating a new format is to add a submodule in
<cite>skbio/io/format/</cite> named after the file format you are implementing.
For example, if the format you are implementing is called <cite>myformat</cite> then you
would create a file called <cite>skbio/io/format/myformat.py</cite>.</p>
<p>The next step is to import the <a class="reference internal" href="skbio.io.registry.create_format.html#skbio.io.registry.create_format" title="skbio.io.registry.create_format"><code class="xref py py-func docutils literal notranslate"><span class="pre">create_format()</span></code></a> factory from
<a class="reference internal" href="../io.html#module-skbio.io" title="skbio.io"><code class="xref py py-mod docutils literal notranslate"><span class="pre">skbio.io</span></code></a>. This will allow you to create a new <a class="reference internal" href="skbio.io.registry.Format.html#skbio.io.registry.Format" title="skbio.io.registry.Format"><code class="xref py py-class docutils literal notranslate"><span class="pre">Format</span></code></a> object
that <cite>io_registry</cite> will know about.</p>
<p>Ideally you should name the result of <a class="reference internal" href="skbio.io.registry.create_format.html#skbio.io.registry.create_format" title="skbio.io.registry.create_format"><code class="xref py py-func docutils literal notranslate"><span class="pre">create_format()</span></code></a> as your file name.
For example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">skbio.io</span> <span class="kn">import</span> <span class="n">create_format</span>

<span class="n">myformat</span> <span class="o">=</span> <span class="n">create_format</span><span class="p">(</span><span class="s1">&#39;myformat&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>The <cite>myformat</cite> object is what we will use to register our new functionality.
At this point you should evaulate whether your format is binary or text.
If your format is binary, your <a class="reference internal" href="skbio.io.registry.create_format.html#skbio.io.registry.create_format" title="skbio.io.registry.create_format"><code class="xref py py-func docutils literal notranslate"><span class="pre">create_format()</span></code></a> call should look like
this:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">myformat</span> <span class="o">=</span> <span class="n">create_format</span><span class="p">(</span><span class="s1">&#39;myformat&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;binary&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Alternatively if your format is text and has a specific encoding or newline
handling you can also specify that:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">myformat</span> <span class="o">=</span> <span class="n">create_format</span><span class="p">(</span><span class="s1">&#39;myformat&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;ascii&#39;</span><span class="p">,</span> <span class="n">newline</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>This will ensure that our registry will open files with a default encoding of
<cite>‘ascii’</cite> for <cite>‘myformat’</cite> and expect all newlines to be <cite>‘n’</cite> characters.</p>
<p>Having worked out these details, we are ready to register the actual
functionality of our format (e.g., sniffer, readers, and writers).</p>
<p>To create a sniffer simply decorate the following onto your sniffer function:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nd">@myformat</span><span class="o">.</span><span class="n">sniffer</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">_myformat_sniffer</span><span class="p">(</span><span class="n">fh</span><span class="p">):</span>
    <span class="c1"># do something with `fh` to determine the membership of the file</span>
</pre></div>
</div>
<p>For futher details on sniffer functions see <a class="reference internal" href="skbio.io.registry.Format.sniffer.html#skbio.io.registry.Format.sniffer" title="skbio.io.registry.Format.sniffer"><code class="xref py py-func docutils literal notranslate"><span class="pre">Format.sniffer()</span></code></a>.</p>
<p>Creating a reader is very similar, but has one difference:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nd">@myformat</span><span class="o">.</span><span class="n">reader</span><span class="p">(</span><span class="n">SomeSkbioClass</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">_myformat_to_some_skbio_class</span><span class="p">(</span><span class="n">fh</span><span class="p">,</span> <span class="n">kwarg1</span><span class="o">=</span><span class="s1">&#39;default&#39;</span><span class="p">,</span> <span class="n">extra</span><span class="o">=</span><span class="n">FileSentinel</span><span class="p">):</span>
    <span class="c1"># parse `fh` and return a SomeSkbioClass instance here</span>
    <span class="c1"># `extra` will also be an open filehandle if provided else None</span>
</pre></div>
</div>
<p>Here we bound a function to a specific class. We also demonstrated using
our FileSentinel object to indicate to the registry that this reader can take
auxilary files that should be handled in the same way as the primary file.
For futher details on reader functions see <a class="reference internal" href="skbio.io.registry.Format.reader.html#skbio.io.registry.Format.reader" title="skbio.io.registry.Format.reader"><code class="xref py py-func docutils literal notranslate"><span class="pre">Format.reader()</span></code></a>.</p>
<p>Creating a writer is about the same:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nd">@myformat</span><span class="o">.</span><span class="n">writer</span><span class="p">(</span><span class="n">SomeSkbioClass</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">_some_skbio_class_to_myformat</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">fh</span><span class="p">,</span> <span class="n">kwarg1</span><span class="o">=</span><span class="s1">&#39;whatever&#39;</span><span class="p">,</span>
                                  <span class="n">extra</span><span class="o">=</span><span class="n">FileSentinel</span><span class="p">):</span>
    <span class="c1"># write the contents of `obj` into `fh` and whatever else into `extra`</span>
    <span class="c1"># do not return anything, it will be ignored</span>
</pre></div>
</div>
<p>This is exactly the same as the <cite>reader</cite> above just in reverse, we also
receive the object we are writing as the first parameter instead of the file
(which is the second one). For further details on writer functions see
<a class="reference internal" href="skbio.io.registry.Format.writer.html#skbio.io.registry.Format.writer" title="skbio.io.registry.Format.writer"><code class="xref py py-func docutils literal notranslate"><span class="pre">Format.writer()</span></code></a>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>When raising errors in readers and writers, the error should be a
subclass of <code class="docutils literal notranslate"><span class="pre">FileFormatError</span></code> specific to your new format.</p>
</div>
<p>Once you are satisfied with the functionality, you will need to ensure that
<cite>skbio/io/__init__.py</cite> contains an import of your new submodule so the
decorators are executed. Add the function
<code class="docutils literal notranslate"><span class="pre">import_module('skbio.io.format.myformat')</span></code> with your module name to the
existing list.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Because scikit-bio handles all of the I/O boilerplate, you only need
to unit-test the actual business logic of your <cite>readers</cite>, <cite>writers</cite>, and
<cite>sniffers</cite>.</p>
</div>
</div>
<div class="section" id="reserved-keyword-arguments">
<h2>Reserved Keyword Arguments<a class="headerlink" href="#reserved-keyword-arguments" title="Permalink to this headline">¶</a></h2>
<p>The following keyword args may not be used when defining new <cite>readers</cite> or
<cite>writers</cite> as they already have special meaning to the registry system:</p>
<ul class="simple">
<li><p><cite>format</cite></p></li>
<li><p><cite>into</cite></p></li>
<li><p><cite>verify</cite></p></li>
<li><p><cite>mode</cite></p></li>
<li><p><cite>encoding</cite></p></li>
<li><p><cite>errors</cite></p></li>
<li><p><cite>newline</cite></p></li>
<li><p><cite>compression</cite></p></li>
<li><p><cite>compresslevel</cite></p></li>
</ul>
<p>The following are not yet used but should be avoided as well:</p>
<ul class="simple">
<li><p><cite>auth</cite></p></li>
<li><p><cite>user</cite></p></li>
<li><p><cite>password</cite></p></li>
<li><p><cite>buffering</cite></p></li>
<li><p><cite>buffer_size</cite></p></li>
<li><p><cite>closefd</cite></p></li>
<li><p><cite>exclusive</cite></p></li>
<li><p><cite>append</cite></p></li>
</ul>
</div>
</div>


    </div>
      
  </div>
</div>
  
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2014--, scikit-bio development team.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 2.4.2.<br/>
    </p>
  </div>
</footer>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-6636235-9', 'scikit-bio.org');
    ga('send', 'pageview');
  </script>

  </body>
</html>