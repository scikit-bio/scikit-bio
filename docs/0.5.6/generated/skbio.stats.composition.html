<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>Composition Statistics (skbio.stats.composition) &#8212; scikit-bio 0.5.6 documentation</title>
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/style.css" />
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="skbio.stats.composition.closure" href="skbio.stats.composition.closure.html" />
    <link rel="prev" title="skbio.stats.power.paired_subsamples" href="skbio.stats.power.paired_subsamples.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">
<script type="text/javascript" src="../_static/js/jquery-1.11.0.min.js "></script>
<script type="text/javascript" src="../_static/js/jquery-fix.js "></script>
<script type="text/javascript" src="../_static/bootstrap-3.3.7/js/bootstrap.min.js "></script>
<script type="text/javascript" src="../_static/bootstrap-sphinx.js "></script>

  </head><body>
  
  <a href="https://github.com/biocore/scikit-bio"
     class="visible-desktop hidden-xs"><img
    id="gh-banner"
    style="position: absolute; top: 50px; right: 0; border: 0;"
    src="https://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png"
    alt="Fork me on GitHub"></a>
  <script>
    // Adjust banner height.
    $(function () {
      var navHeight = $(".navbar .container").css("height");
      $("#gh-banner").css("top", navHeight);
    });
  </script>


  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../index.html">
          scikit-bio docs</a>
        <span class="navbar-text navbar-version pull-left"><b>0.5.6</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../io.html">File I/O (<code class="xref py py-mod docutils literal notranslate"><span class="pre">skbio.io</span></code>)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sequence.html">Sequences (<code class="xref py py-mod docutils literal notranslate"><span class="pre">skbio.sequence</span></code>)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../alignment.html">Alignments (<code class="xref py py-mod docutils literal notranslate"><span class="pre">skbio.alignment</span></code>)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tree.html">Tree representations (<code class="xref py py-mod docutils literal notranslate"><span class="pre">skbio.tree</span></code>)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../workflow.html">Constructing workflows (<code class="xref py py-mod docutils literal notranslate"><span class="pre">skbio.workflow</span></code>)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../diversity.html">Diversity calculations (<code class="xref py py-mod docutils literal notranslate"><span class="pre">skbio.diversity</span></code>)</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../stats.html">Statistics (<code class="xref py py-mod docutils literal notranslate"><span class="pre">skbio.stats</span></code>)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../metadata.html">Metadata (<code class="xref py py-mod docutils literal notranslate"><span class="pre">skbio.metadata</span></code>)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../util.html">Utility functionality (<code class="xref py py-mod docutils literal notranslate"><span class="pre">skbio.util</span></code>)</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../user/api_stability.html">API Stability</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../development/coding_guidelines.html">Coding guidelines</a></li>
<li class="toctree-l1"><a class="reference internal" href="../development/new_module.html">Adding a new module to skbio</a></li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">Composition Statistics (<code class="xref py py-mod docutils literal notranslate"><span class="pre">skbio.stats.composition</span></code>)</a><ul>
<li><a class="reference internal" href="#functions">Functions</a></li>
</ul>
</li>
</ul>
</ul>
</li>
              
            
            
            
            
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="body col-md-12 content" role="main">
      
  <span class="target" id="module-skbio.stats.composition"></span><div class="section" id="composition-statistics-skbio-stats-composition">
<h1>Composition Statistics (<a class="reference internal" href="#module-skbio.stats.composition" title="skbio.stats.composition"><code class="xref py py-mod docutils literal notranslate"><span class="pre">skbio.stats.composition</span></code></a>)<a class="headerlink" href="#composition-statistics-skbio-stats-composition" title="Permalink to this headline">¶</a></h1>
<p>This module provides functions for compositional data analysis.</p>
<p>Many ‘omics datasets are inherently compositional - meaning that they
are best interpreted as proportions or percentages rather than
absolute counts.</p>
<p>Formally, <span class="math notranslate nohighlight">\(x\)</span> is a composition if <span class="math notranslate nohighlight">\(\sum_{i=0}^D x_{i} = c\)</span>
and <span class="math notranslate nohighlight">\(x_{i} &gt; 0\)</span>, <span class="math notranslate nohighlight">\(1 \leq i \leq D\)</span> and <span class="math notranslate nohighlight">\(c\)</span> is a real
valued constant and there are <span class="math notranslate nohighlight">\(D\)</span> components for each
composition. In this module <span class="math notranslate nohighlight">\(c=1\)</span>. Compositional data can be
analyzed using Aitchison geometry. <a class="footnote-reference brackets" href="#id4" id="id1">1</a></p>
<p>However, in this framework, standard real Euclidean operations such as
addition and multiplication no longer apply. Only operations such as
perturbation and power can be used to manipulate this data.</p>
<p>This module allows two styles of manipulation of compositional data.
Compositional data can be analyzed using perturbation and power
operations, which can be useful for simulation studies. The
alternative strategy is to transform compositional data into the real
space.  Right now, the centre log ratio transform (clr) and
the isometric log ratio transform (ilr) <a class="footnote-reference brackets" href="#id5" id="id2">2</a> can be used to accomplish
this. This transform can be useful for performing standard statistical
tools such as parametric hypothesis testing, regressions and more.</p>
<p>The major caveat of using this framework is dealing with zeros.  In
the Aitchison geometry, only compositions with nonzero components can
be considered. The multiplicative replacement technique <a class="footnote-reference brackets" href="#id6" id="id3">3</a> can be
used to substitute these zeros with small pseudocounts without
introducing major distortions to the data.</p>
<div class="section" id="functions">
<h2>Functions<a class="headerlink" href="#functions" title="Permalink to this headline">¶</a></h2>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="skbio.stats.composition.closure.html#skbio.stats.composition.closure" title="skbio.stats.composition.closure"><code class="xref py py-obj docutils literal notranslate"><span class="pre">closure</span></code></a>(mat)</p></td>
<td><p>State: Experimental as of 0.4.0.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="skbio.stats.composition.multiplicative_replacement.html#skbio.stats.composition.multiplicative_replacement" title="skbio.stats.composition.multiplicative_replacement"><code class="xref py py-obj docutils literal notranslate"><span class="pre">multiplicative_replacement</span></code></a>(mat[, delta])</p></td>
<td><p>Replace all zeros with small non-zero values</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="skbio.stats.composition.perturb.html#skbio.stats.composition.perturb" title="skbio.stats.composition.perturb"><code class="xref py py-obj docutils literal notranslate"><span class="pre">perturb</span></code></a>(x, y)</p></td>
<td><p>State: Experimental as of 0.4.0.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="skbio.stats.composition.perturb_inv.html#skbio.stats.composition.perturb_inv" title="skbio.stats.composition.perturb_inv"><code class="xref py py-obj docutils literal notranslate"><span class="pre">perturb_inv</span></code></a>(x, y)</p></td>
<td><p>State: Experimental as of 0.4.0.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="skbio.stats.composition.power.html#skbio.stats.composition.power" title="skbio.stats.composition.power"><code class="xref py py-obj docutils literal notranslate"><span class="pre">power</span></code></a>(x, a)</p></td>
<td><p>State: Experimental as of 0.4.0.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="skbio.stats.composition.inner.html#skbio.stats.composition.inner" title="skbio.stats.composition.inner"><code class="xref py py-obj docutils literal notranslate"><span class="pre">inner</span></code></a>(x, y)</p></td>
<td><p>State: Experimental as of 0.4.0.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="skbio.stats.composition.clr.html#skbio.stats.composition.clr" title="skbio.stats.composition.clr"><code class="xref py py-obj docutils literal notranslate"><span class="pre">clr</span></code></a>(mat)</p></td>
<td><p>State: Experimental as of 0.4.0.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="skbio.stats.composition.clr_inv.html#skbio.stats.composition.clr_inv" title="skbio.stats.composition.clr_inv"><code class="xref py py-obj docutils literal notranslate"><span class="pre">clr_inv</span></code></a>(mat)</p></td>
<td><p>State: Experimental as of 0.4.0.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="skbio.stats.composition.ilr.html#skbio.stats.composition.ilr" title="skbio.stats.composition.ilr"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ilr</span></code></a>(mat[, basis, check])</p></td>
<td><p>State: Experimental as of 0.4.0.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="skbio.stats.composition.ilr_inv.html#skbio.stats.composition.ilr_inv" title="skbio.stats.composition.ilr_inv"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ilr_inv</span></code></a>(mat[, basis, check])</p></td>
<td><p>State: Experimental as of 0.4.0.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="skbio.stats.composition.alr.html#skbio.stats.composition.alr" title="skbio.stats.composition.alr"><code class="xref py py-obj docutils literal notranslate"><span class="pre">alr</span></code></a>(mat[, denominator_idx])</p></td>
<td><p>State: Experimental as of 0.5.5.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="skbio.stats.composition.alr_inv.html#skbio.stats.composition.alr_inv" title="skbio.stats.composition.alr_inv"><code class="xref py py-obj docutils literal notranslate"><span class="pre">alr_inv</span></code></a>(mat[, denominator_idx])</p></td>
<td><p>State: Experimental as of 0.5.5.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="skbio.stats.composition.centralize.html#skbio.stats.composition.centralize" title="skbio.stats.composition.centralize"><code class="xref py py-obj docutils literal notranslate"><span class="pre">centralize</span></code></a>(mat)</p></td>
<td><p>Center data around its geometric average.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="skbio.stats.composition.ancom.html#skbio.stats.composition.ancom" title="skbio.stats.composition.ancom"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ancom</span></code></a>(table, grouping[, alpha, tau, theta, …])</p></td>
<td><p>Performs a differential abundance test using ANCOM.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="skbio.stats.composition.sbp_basis.html#skbio.stats.composition.sbp_basis" title="skbio.stats.composition.sbp_basis"><code class="xref py py-obj docutils literal notranslate"><span class="pre">sbp_basis</span></code></a>(sbp)</p></td>
<td><p>State: Experimental as of 0.5.5.</p></td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<dl class="footnote brackets">
<dt class="label" id="id4"><span class="brackets"><a class="fn-backref" href="#id1">1</a></span></dt>
<dd><p>V. Pawlowsky-Glahn, J. J. Egozcue, R. Tolosana-Delgado (2015),
Modeling and Analysis of Compositional Data, Wiley, Chichester, UK</p>
</dd>
<dt class="label" id="id5"><span class="brackets"><a class="fn-backref" href="#id2">2</a></span></dt>
<dd><p>J. J. Egozcue.,  “Isometric Logratio Transformations for
Compositional Data Analysis” Mathematical Geology, 35.3 (2003)</p>
</dd>
<dt class="label" id="id6"><span class="brackets"><a class="fn-backref" href="#id3">3</a></span></dt>
<dd><p>J. A. Martin-Fernandez,  “Dealing With Zeros and Missing Values in
Compositional Data Sets Using Nonparametric Imputation”,
Mathematical Geology, 35.3 (2003)</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</pre></div>
</div>
<p>Consider a very simple environment with only 3 species. The species
in the environment are equally distributed and their proportions are
equivalent:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">otus</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="mf">1.</span><span class="o">/</span><span class="mf">3.</span><span class="p">,</span> <span class="mf">1.</span><span class="o">/</span><span class="mi">3</span><span class="p">])</span>
</pre></div>
</div>
<p>Suppose that an antibiotic kills off half of the population for the
first two species, but doesn’t harm the third species. Then the
perturbation vector would be as follows</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">antibiotic</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mf">1.</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
<p>And the resulting perturbation would be</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">perturb</span><span class="p">(</span><span class="n">otus</span><span class="p">,</span> <span class="n">antibiotic</span><span class="p">)</span>
<span class="go">array([ 0.25,  0.25,  0.5 ])</span>
</pre></div>
</div>
</div>
</div>


    </div>
      
  </div>
</div>
  
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2014--, scikit-bio development team.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 2.4.2.<br/>
    </p>
  </div>
</footer>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-6636235-9', 'scikit-bio.org');
    ga('send', 'pageview');
  </script>

  </body>
</html>