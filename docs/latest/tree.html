<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Tree representations (skbio.tree) &#8212; scikit-bio 0.5.2 documentation</title>
    <link rel="stylesheet" href="_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/style.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.5.2',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/copybutton.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="_static/bootstrap-3.3.7/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="_static/bootstrap-sphinx.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="skbio.tree.TreeNode" href="generated/skbio.tree.TreeNode.html" />
    <link rel="prev" title="skbio.alignment.make_identity_substitution_matrix" href="generated/skbio.alignment.make_identity_substitution_matrix.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  </head>
  <body>
  
  <a href="https://github.com/biocore/scikit-bio"
     class="visible-desktop hidden-xs"><img
    id="gh-banner"
    style="position: absolute; top: 50px; right: 0; border: 0;"
    src="https://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png"
    alt="Fork me on GitHub"></a>
  <script>
    // Adjust banner height.
    $(function () {
      var navHeight = $(".navbar .container").css("height");
      $("#gh-banner").css("top", navHeight);
    });
  </script>


  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="index.html">
          scikit-bio docs</a>
        <span class="navbar-text navbar-version pull-left"><b>0.5.2</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul class="current">
<li class="toctree-l1"><a class="reference internal" href="io.html">File I/O (<code class="docutils literal"><span class="pre">skbio.io</span></code>)</a></li>
<li class="toctree-l1"><a class="reference internal" href="sequence.html">Sequences (<code class="docutils literal"><span class="pre">skbio.sequence</span></code>)</a></li>
<li class="toctree-l1"><a class="reference internal" href="alignment.html">Alignments (<code class="docutils literal"><span class="pre">skbio.alignment</span></code>)</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Tree representations (<code class="docutils literal"><span class="pre">skbio.tree</span></code>)</a></li>
<li class="toctree-l1"><a class="reference internal" href="workflow.html">Constructing workflows (<code class="docutils literal"><span class="pre">skbio.workflow</span></code>)</a></li>
<li class="toctree-l1"><a class="reference internal" href="diversity.html">Diversity calculations (<code class="docutils literal"><span class="pre">skbio.diversity</span></code>)</a></li>
<li class="toctree-l1"><a class="reference internal" href="stats.html">Statistics (<code class="docutils literal"><span class="pre">skbio.stats</span></code>)</a></li>
<li class="toctree-l1"><a class="reference internal" href="metadata.html">Metadata (<code class="docutils literal"><span class="pre">skbio.metadata</span></code>)</a></li>
<li class="toctree-l1"><a class="reference internal" href="util.html">Utility functionality (<code class="docutils literal"><span class="pre">skbio.util</span></code>)</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="user/api_stability.html">API Stability</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="development/coding_guidelines.html">Coding guidelines</a></li>
<li class="toctree-l1"><a class="reference internal" href="development/new_module.html">Adding a new module to skbio</a></li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">Tree representations (<code class="docutils literal"><span class="pre">skbio.tree</span></code>)</a><ul>
<li><a class="reference internal" href="#classes">Classes</a></li>
<li><a class="reference internal" href="#phylogenetic-reconstruction">Phylogenetic Reconstruction</a></li>
<li><a class="reference internal" href="#utility-functions">Utility Functions</a></li>
<li><a class="reference internal" href="#exceptions">Exceptions</a></li>
<li><a class="reference internal" href="#examples">Examples</a></li>
</ul>
</li>
</ul>
</ul>
</li>
              
            
            
            
            
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12 content">
      
  <span class="target" id="module-skbio.tree"></span><div class="section" id="tree-representations-skbio-tree">
<h1>Tree representations (<a class="reference internal" href="#module-skbio.tree" title="skbio.tree"><code class="xref py py-mod docutils literal"><span class="pre">skbio.tree</span></code></a>)<a class="headerlink" href="#tree-representations-skbio-tree" title="Permalink to this headline">¶</a></h1>
<p>This module provides functionality for working with trees, including
phylogenetic trees and hierarchies. Functionality is provided for constructing
trees, for traversing in multiple ways, comparisons, fetching subtrees, and
more. This module supports trees that are multifurcating and nodes that have
single descendants.</p>
<div class="section" id="classes">
<h2>Classes<a class="headerlink" href="#classes" title="Permalink to this headline">¶</a></h2>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="generated/skbio.tree.TreeNode.html#skbio.tree.TreeNode" title="skbio.tree.TreeNode"><code class="xref py py-obj docutils literal"><span class="pre">TreeNode</span></code></a>([name,&nbsp;length,&nbsp;parent,&nbsp;children])</td>
<td>Representation of a node within a tree</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="phylogenetic-reconstruction">
<h2>Phylogenetic Reconstruction<a class="headerlink" href="#phylogenetic-reconstruction" title="Permalink to this headline">¶</a></h2>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="generated/skbio.tree.nj.html#skbio.tree.nj" title="skbio.tree.nj"><code class="xref py py-obj docutils literal"><span class="pre">nj</span></code></a>(dm[,&nbsp;disallow_negative_branch_length,&nbsp;…])</td>
<td>Apply neighbor joining for phylogenetic reconstruction.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="utility-functions">
<h2>Utility Functions<a class="headerlink" href="#utility-functions" title="Permalink to this headline">¶</a></h2>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="generated/skbio.tree.majority_rule.html#skbio.tree.majority_rule" title="skbio.tree.majority_rule"><code class="xref py py-obj docutils literal"><span class="pre">majority_rule</span></code></a>(trees[,&nbsp;weights,&nbsp;cutoff,&nbsp;…])</td>
<td>Determines consensus trees from a list of rooted trees</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="exceptions">
<h2>Exceptions<a class="headerlink" href="#exceptions" title="Permalink to this headline">¶</a></h2>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="generated/skbio.tree.TreeError.html#skbio.tree.TreeError" title="skbio.tree.TreeError"><code class="xref py py-obj docutils literal"><span class="pre">TreeError</span></code></a></td>
<td>General tree error</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="generated/skbio.tree.NoLengthError.html#skbio.tree.NoLengthError" title="skbio.tree.NoLengthError"><code class="xref py py-obj docutils literal"><span class="pre">NoLengthError</span></code></a></td>
<td>Missing length when expected</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="generated/skbio.tree.DuplicateNodeError.html#skbio.tree.DuplicateNodeError" title="skbio.tree.DuplicateNodeError"><code class="xref py py-obj docutils literal"><span class="pre">DuplicateNodeError</span></code></a></td>
<td>Duplicate nodes with identical names</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="generated/skbio.tree.MissingNodeError.html#skbio.tree.MissingNodeError" title="skbio.tree.MissingNodeError"><code class="xref py py-obj docutils literal"><span class="pre">MissingNodeError</span></code></a></td>
<td>Expecting a node</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="generated/skbio.tree.NoParentError.html#skbio.tree.NoParentError" title="skbio.tree.NoParentError"><code class="xref py py-obj docutils literal"><span class="pre">NoParentError</span></code></a></td>
<td>Missing a parent</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="examples">
<h2>Examples<a class="headerlink" href="#examples" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">skbio</span> <span class="k">import</span> <span class="n">TreeNode</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">io</span> <span class="k">import</span> <span class="n">StringIO</span>
</pre></div>
</div>
<p>A new tree can be constructed from a Newick string. Newick is a common format
used to represent tree objects within a file. Newick was part of the original
PHYLIP package from Joseph Felsenstein’s group (defined <a class="reference external" href="http://goo.gl/fIY1Iq">here</a>), and is based around representing nesting with
parentheses. For instance, the following string describes a 3 taxon tree, with
one internal node:</p>
<blockquote>
<div>((A, B)C, D)root;</div></blockquote>
<p>Where A, B, and D are tips of the tree, and C is an internal node that covers
tips A and B.</p>
<p>Now let’s construct a simple tree and dump an ASCII representation:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">tree</span> <span class="o">=</span> <span class="n">TreeNode</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">StringIO</span><span class="p">(</span><span class="s2">&quot;((A, B)C, D)root;&quot;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">tree</span><span class="o">.</span><span class="n">is_root</span><span class="p">())</span> <span class="c1"># is this the root of the tree?</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">tree</span><span class="o">.</span><span class="n">is_tip</span><span class="p">())</span> <span class="c1"># is this node a tip?</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">tree</span><span class="o">.</span><span class="n">ascii_art</span><span class="p">())</span>
<span class="go">                    /-A</span>
<span class="go">          /C-------|</span>
<span class="go">-root----|          \-B</span>
<span class="go">         |</span>
<span class="go">          \-D</span>
</pre></div>
</div>
<p>There are a few common ways to traverse a tree, and depending on your use,
some methods are more appropriate than others. Wikipedia has a well written
page on tree <a class="reference external" href="http://goo.gl/K4Ufl">traversal methods</a>, and will go into
further depth than what we’ll cover here. We’re only going to cover two of the
commonly used traversals here, preorder and postorder, but we will show
examples of two other common helper traversal methods to gather tips or
internal nodes.</p>
<p>The first traversal we’ll cover is a preorder traversal in which you evaluate
from root to tips, looking at the left most child first. For instance:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">tree</span><span class="o">.</span><span class="n">preorder</span><span class="p">():</span>
<span class="gp">... </span>   <span class="nb">print</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
<span class="go">root</span>
<span class="go">C</span>
<span class="go">A</span>
<span class="go">B</span>
<span class="go">D</span>
</pre></div>
</div>
<p>The next method we’ll look at is a postorder traveral which will evaluate the
left subtree tips first before walking back up the tree:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">tree</span><span class="o">.</span><span class="n">postorder</span><span class="p">():</span>
<span class="gp">... </span>   <span class="nb">print</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
<span class="go">A</span>
<span class="go">B</span>
<span class="go">C</span>
<span class="go">D</span>
<span class="go">root</span>
</pre></div>
</div>
<p><cite>TreeNode</cite> provides two helper methods as well for iterating over just the tips
or for iterating over just the internal nodes.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">tree</span><span class="o">.</span><span class="n">tips</span><span class="p">():</span>
<span class="gp">... </span>   <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Node name: </span><span class="si">%s</span><span class="s2">, Is a tip: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">node</span><span class="o">.</span><span class="n">is_tip</span><span class="p">()))</span>
<span class="go">Node name: A, Is a tip: True</span>
<span class="go">Node name: B, Is a tip: True</span>
<span class="go">Node name: D, Is a tip: True</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">tree</span><span class="o">.</span><span class="n">non_tips</span><span class="p">():</span>
<span class="gp">... </span>   <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Node name: </span><span class="si">%s</span><span class="s2">, Is a tip: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">node</span><span class="o">.</span><span class="n">is_tip</span><span class="p">()))</span>
<span class="go">Node name: C, Is a tip: False</span>
</pre></div>
</div>
<p>Note, by default, <cite>non_tips</cite> will ignore <cite>self</cite> (which is the root in this
case).  You can pass the <cite>include_self</cite> flag to <cite>non_tips</cite> if you wish to
include <cite>self</cite>.</p>
<p>The <cite>TreeNode</cite> provides a few ways to compare trees. First, let’s create two
similar trees and compare their topologies using <cite>compare_subsets</cite>. This
distance is the fraction of common clades present in the two trees, where a
distance of 0 means the trees contain identical clades, and a distance of 1
indicates the trees do not share any common clades:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">tree1</span> <span class="o">=</span> <span class="n">TreeNode</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">StringIO</span><span class="p">(</span><span class="s2">&quot;((A, B)C, (D, E)F, (G, H)I)root;&quot;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tree2</span> <span class="o">=</span> <span class="n">TreeNode</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">StringIO</span><span class="p">(</span><span class="s2">&quot;((G, H)C, (D, E)F, (B, A)I)root;&quot;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tree3</span> <span class="o">=</span> <span class="n">TreeNode</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">StringIO</span><span class="p">(</span><span class="s2">&quot;((D, B)C, (A, E)F, (G, H)I)root;&quot;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">tree1</span><span class="o">.</span><span class="n">compare_subsets</span><span class="p">(</span><span class="n">tree1</span><span class="p">))</span>  <span class="c1"># identity case</span>
<span class="go">0.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">tree1</span><span class="o">.</span><span class="n">compare_subsets</span><span class="p">(</span><span class="n">tree2</span><span class="p">))</span>  <span class="c1"># same tree but different clade order</span>
<span class="go">0.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">tree1</span><span class="o">.</span><span class="n">compare_subsets</span><span class="p">(</span><span class="n">tree3</span><span class="p">))</span>  <span class="c1"># only 1 of 3 common subsets</span>
<span class="go">0.6666666666666667</span>
</pre></div>
</div>
<p>We can additionally take into account branch length when computing distances
between trees. First, we’re going to construct two new trees with described
branch length, note the difference in the Newick strings:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">tree1</span> <span class="o">=</span> \
<span class="gp">... </span>    <span class="n">TreeNode</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">StringIO</span><span class="p">(</span><span class="s2">&quot;((A:0.1, B:0.2)C:0.3, D:0.4, E:0.5)root;&quot;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tree2</span> <span class="o">=</span> \
<span class="gp">... </span>    <span class="n">TreeNode</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">StringIO</span><span class="p">(</span><span class="s2">&quot;((A:0.4, B:0.8)C:0.3, D:0.1, E:0.5)root;&quot;</span><span class="p">))</span>
</pre></div>
</div>
<p>In these two trees, we’ve added on a description of length from the node to
its parent, so for instance:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">tree1</span><span class="o">.</span><span class="n">postorder</span><span class="p">():</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">node</span><span class="o">.</span><span class="n">length</span><span class="p">)</span>
<span class="go">A 0.1</span>
<span class="go">B 0.2</span>
<span class="go">C 0.3</span>
<span class="go">D 0.4</span>
<span class="go">E 0.5</span>
<span class="go">root None</span>
</pre></div>
</div>
<p>Now let’s compare two trees using the distances computed pairwise between tips
in the trees. The distance computed, by default, is the correlation of all
pairwise tip-to-tip distances between trees:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">tree1</span><span class="o">.</span><span class="n">compare_tip_distances</span><span class="p">(</span><span class="n">tree1</span><span class="p">))</span>  <span class="c1"># identity case</span>
<span class="go">0.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">tree1</span><span class="o">.</span><span class="n">compare_tip_distances</span><span class="p">(</span><span class="n">tree2</span><span class="p">))</span>
<span class="go">0.120492524415</span>
</pre></div>
</div>
</div>
</div>


    </div>
      
  </div>
</div>
  
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2014--, scikit-bio development team.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.6.5.<br/>
    </p>
  </div>
</footer>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-6636235-9', 'scikit-bio.org');
    ga('send', 'pageview');
  </script>

  </body>
</html>